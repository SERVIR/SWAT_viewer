{% extends "swat/base.html" %}
{% load staticfiles %}
{% load tethys_gizmos %}

{% block import_gizmos %}
    {% import_gizmo_dependency plotly_view %}
{% endblock %}

{% block styles %}
{{ block.super }}
<!--<link rel="stylesheet" href="https://code.jquery.com/ui/3.3.1/themes/smoothness/jquery-ui.css">-->
<link rel="stylesheet" href="https://openlayers.org/en/v4.3.1/css/ol.css" type="text/css">
<link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" type="text/css">
{% endblock %}

{% block global_scripts %}
{{block.super}}
<!--<script src="https://code.jquery.com/ui/3.3.1/jquery-ui.js"></script>-->
<script src="https://openlayers.org/en/v4.3.1/build/ol.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
{% endblock %}

{% block header_buttons %}
  <div id="paramSelect" style="margin-right: 25px; margin-top: 12px">
    {% gizmo param_select %}
  </div>
  <div id="datePickStart" style="margin-right: 25px; margin-top: 12px">
    {% gizmo start_pick %}
  </div>
  <div id="datePickEnd" style="margin-right: 25px; margin-top: 12px">
    {% gizmo end_pick %}
  </div>
  <div class="header-button glyphicon-button" data-toggle="tooltip" data-placement="bottom" title="How-to">
    <a data-toggle="modal" data-target="#help-modal"><span class="glyphicon glyphicon-question-sign"></span></a>
  </div>
{% endblock %}


{% block app_content_override %}

  <style>
    #map{
        width:100%;
        height:100%;
    }
    .map-view-legend {
        bottom: 85px;
        right: 5px;
        width: 170px;
        max-height: 90%;
        overflow-y: auto;
        margin: 5px;
        color:white;
        background: #286090;
        border: 1px #ddd solid;
        z-index: 999;
    }
  </style>
  <div id="map" class="map"></div>
  <div id="popup" class="popup"></div>
{% endblock %}

{# Use the after_app_content block for modals #}
{% block after_app_content %}
  <!-- How-To Modal-->
  <div class="modal fade" id="help-modal" tabindex="-1" role="dialog" aria-labelledby="help-modal-label">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h5 class="modal-title" id="help-modal-label">SWAT Data Viewer - How-to</h5>
        </div>
        <div class="modal-body">
          <p>
            <ol>
              <li>Select the parameter that you want to view from the "Select Parameter" drop down menu</li>
              <li>Select the date that you want the time-series to start with in the "Select Start Date" date picker</li>
              <li>Select the date that you want the time-series to start with in the "Select End Date" date picker</li>
              <li>Select a stream on the map and click the "View Time-Series" button</li>
            </ol>
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>

  <!--Time-Series Viewer Modal-->
  <div class="modal fade" id="ts-modal" tabindex="-1" role="dialog" aria-labelledby="ts-modal-label">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <div class="flex-container-row"><img id="view-file-loading" class="view-file hidden" src="/static/swat/images/loader.gif" style="margin: auto"/></div>
          <div id="container" class="view_chart hidden" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
          <br>
          <div id="download_data" class="btn-group hidden long-term-select" role="group">
            <a class="btn btn-success" role="button" id="submit-download-data" href="/swat/workspaces/app_workspace/download/swat_data.csv" download>
              <span class="glyphicon glyphicon-download-alt"></span>&nbsp;&nbsp;Download Data</a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block app_actions %}
{% endblock %}